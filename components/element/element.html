<div ng-if="sending" style="text-align: center; color: cadetblue;">
	<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
</div>

<div ng-if="type == 'paragraph' && inline != 'true'">
	<p ng-bind-html="data_source.value"></p>
</div>

<span ng-if="type == 'paragraph' && inline == 'true'" ng-bind-html="data_source.value">
</span>

<span ng-if="type == 'image'">
	<img style="max-width:{{data_source.width || '100%'}}; vertical-align: middle;" ng-src="{{data_source.url}}"></img>
</span>

<hr ng-if="type == 'divider'" class="divider">

<span ng-if='type == "icon"' style="vertical-align: sub; padding: 5px;">
	<i class="fa {{data_source.icon}} {{data_source.modifiers}}" aria-label="{{data_source.title}}" title="{{data_source.title}}" style="color: {{data_source.color}}"></i>
</span>

<div ng-if="type == 'bullet_list'">
	<ul>
		<li ng-repeat="item in data">
			<p ng-bind-html="item"></p>
		</li>
	</ul>
</div>

<div ng-if="type == 'table'" style="max-height: 300px; overflow: auto;">

	<table md-table md-row-select multiple>
		<tbody md-body>
			<thead md-head>
				<tr md-row md-auto-select>
					<th style="word-break: break-word; width: 100px; overflow-wrap: break-word; word-wrap: break-word;" md-cell md-column ng-repeat="label in subdata.header track by $index">
						<span>{{label}}</span>
					</th>
				</tr>
			</thead>
			<tr md-row md-auto-select ng-repeat="item in subdata.items track by $index">
              <td style="width: 100px; overflow-wrap: break-word;" md-cell ng-switch="field.type" ng-repeat="field in item track by $index">
                <span ng-switch-when="undefined">
              		<span>{{field}}</span>
              	</span>
              	
                <div ng-switch-default>
                	<md-button ng-if='field.type == "button" && field.action == "dialog"' ng-click="show_dialog($event, field.card)" class="md-raised md-primary">{{field.label}}</md-button>
                	<form ng-if='field.type == "button" && field.action == "download"' method="get" action="{{field.url}}">
                		<md-button type="submit" class="md-raised md-primary">{{label}}</md-button>
                	</form>
              		<a download	ng-if='field.type == "download"' ng-href="{{field.url}}"><img ng-if="field.icon !== undefined" class="icon" ng-src="{{field.icon}}"/>{{field.label}}</a>
                </div>
                
              </td>
			</tr>
		</tbody>
		
	 </table>

<!-- 	<table md-table md-row-select multiple> -->
<!-- 		<tbody md-body> -->
<!-- 			<thead md-head> -->
<!-- 				<tr md-row> -->
<!-- 					<th md-column ng-repeat="label in subdata.labels"><span>{{label}}</span></th> -->
<!-- 				</tr> -->
<!-- 			</thead> -->
<!-- 			<tr md-row md-auto-select ng-repeat="label in subdata.header track by $index"> -->
<!-- 				<td md-cell style="font-weight: bold;"><span>{{label}}</span></td> -->
<!-- 				<td md-cell style="text-align: right;"><span>{{subdata.items[$index]}}</span></td> -->
<!-- 			</tr> -->
<!-- 		</tbody> -->
<!-- 	 </table> -->
</div>

<div ng-if="type == 'two-column-table'" style="max-height: 500px; overflow: auto;">
	<table md-table md-row-select multiple>
		<tbody md-body>
			<thead md-head>
				<tr md-row md-auto-select>
					<th md-column ng-repeat="label in subdata.labels"><span>{{label}}</span></th>
				</tr>
			</thead>
			<tr md-row md-auto-select ng-repeat="label in subdata.header track by $index">
				<td md-cell style="font-weight: bold;"><span>{{label}}</span></td>
				<td md-cell style="text-align: right;"><span>{{subdata.items[0][$index]}}</span></td>
			</tr>
		</tbody>
	 </table>
</div>

<div ng-if="type == 'list'" style="max-height: 300px; overflow: auto;">
	<table md-table md-row-select multiple>
		<tbody md-body>
			<tr md-row md-auto-select ng-repeat="item in subdata.items track by $index">
				<td md-cell style="font-weight: bold;"><span>{{($index+1) + '.'}}</span></td>
				<td md-cell><span>{{item}}</span></td>
				<td ng-if="module_info.info" md-cell>
					<md-button class="md-primary md-raised" style="text-decoration: none;" ng-href="{{module_info.info + 'http://localhost/rnaseq/data/bams/' + item}}">
								<span class="fa fa-bar-chart fa-lg"></span>
								<span style="">See stats</span>
					</md-button>
				</td>
				<td ng-if="module_info.explore" md-cell>
					<md-button class="md-primary md-raised" style="text-decoration: none;" ng-href="{{module_info.explore + 'http://localhost/rnaseq/data/bams/' + item}}">
								<span class="fa fa-braille fa-lg"></span>
								<span style="">See file</span>
					</md-button>
				</td>
			</tr>
		</tbody>
	</table>
</div>

<div ng-if="type == 'chart-pie'">
	<canvas
		class="chart chart-pie"
		chart-data="subdata.points"
		chart-labels="subdata.labels"
		chart-options="subdata.options"
		chart-click="onClick"
		>
	</canvas>
</div>


<div ng-if="type == 'chart-doughnut'">
	<canvas
		class="chart chart-doughnut"
		chart-data="subdata.points"
		chart-labels="subdata.labels"
		chart-options="subdata.options"
		chart-click="onClick"
		>
	</canvas>
</div>

<div ng-if="type == 'chart-bar'">
	<canvas
		class="chart chart-bar"
		chart-data="subdata.points"
		chart-labels="subdata.labels"
		chart-series="subdata.series"
		chart-click="onClick"
		chart-options="subdata.options"
		>
	</canvas>
</div>

<div ng-if="type == 'paginated-table'">
	<md-table-container>
	  <table md-table ng-model="selected" md-progress="promise">
	    <thead md-head>
	      <th md-column style="text-align: center; padding-bottom:20px;">
	      Line no.
	      </th>
	      <th md-column style="text-align: center; padding-bottom:20px;" ng-repeat="col in subdata.header">
	      	<span>{{col}}</span>
	      </th>
	    </thead>
	    <tbody md-body>
	      <tr md-row md-auto-select ng-repeat="row in subdata.items track by $index">
	        <td md-cell style="text-align: center; padding: 20px;"><b>{{(query.page-1)*query.limit + $index +1}}</b></td>
			<td md-cell style="text-align: center;" ng-repeat="field in row track by $index">
				<span ng-if="!url">{{field}}</span>
			</td>
		  </tr>
	    </tbody>
	  </table>
	</md-table-container>
	<md-table-pagination
		md-limit="query.limit"
		md-limit-options="[5, 10, 15]"
		md-page="query.page"
		md-on-paginate="update_table"
		md-total="{{query.total}}"
		md-page-select>
	</md-table-pagination>
</div>

<div ng-if="type == 'slider'">
	<div>
		<p style="display: inline-block;" ng-bind="label"></p>:
		<span ng-bind="data_source.value"></span>
	</div>
	<md-slider-container>
		<md-slider	step="{{data_source.step}}"
					md-discrete
					class="md-primary"
					flex
					min="{{data_source.min}}"
					max="{{data_source.max}}"
					ng-model="data_source.value"
					aria-label="{{label}}"
					ng-change="onChange(data_source.value)"
					>
		</md-slider>
	</md-slider-container>
</div>

<!-- words="[{text: 'Lorem', weight: 13}, {text: 'Ipsum', weight: 10.5}, {text: 'Dolor', weight: 9.4}, {text: 'Sit', weight: 8}, {text: 'Amet', weight: 6.2}, {text: 'Consectetur', weight: 5}, {text: 'Adipiscing', weight: 5}]" -->
<div ng-if="type == 'cloud'" align="center" ng-controller="cloudController">
	<jqcloud
		words="subdata"
		width="{{width}}"
		height="{{height}}"
		steps="{{steps}}">
	</jqcloud>
</div>

<div ng-if="type == 'tree'" ng-controller="treeController" style="overflow: scroll;">
	<svg id="tree"></svg>
</div>

<div ng-if="type == 'circos'" ng-controller="circosController">
	<div align="center" style="font-size: 0.5em;" id="biocircos" ng-show="!sending"></div>
</div>

<div class="container well" ng-if="type == 'venn'">
	<div venn="subdata"></div>
</div>

<md-input-container class="md-input-has-placeholder" ng-if="['select', 'text', 'checkbox', 'textarea', 'autocomplete'].indexOf(type) !== -1">
	<md-content ng-if="type != 'autocomplete'">
		<label ng-if="type != 'checkbox'" ng-bind="data_source.label"></label>
		
		<input ng-if="type != 'choice' && type != 'select' && type != 'autocomplete' && type != 'checkbox'" placeholder="{{placeholder}}" ng-model="data_source.value" ng-value="{{data_source.default}}" type="{{type}}"/>
		
		<md-select ng-model="data_source.value" ng-if="type == 'select' && (!data_source.multiple || data_source.multiple == false)" ng-change="onChange(data_source.value)" ng-model-options="{trackBy: '$value.id'}">
			<md-option ng-value="value" ng-repeat="value in subdata track by $index"><span>{{value.label}}</span> <span style="color: grey">(ID: {{value.id}})</span></md-option>
		</md-select>
		<md-select multiple ng-model="data_source.value" ng-if="type == 'select' && data_source.multiple && data_source.multiple == true" ng-model-options="{trackBy: '$value.id'}">
			<md-option ng-value="value" ng-repeat="value in subdata track by $index">{{value}}</md-option>
		</md-select>

		<fieldset ng-if="type == 'checkbox' && subdata != undefined">
              	<legend>{{label}}</legend>
	            	<md-checkbox ng-checked="exists(value, subdata)" ng-click="toggle(value, subdata)" ng-repeat="value in subdata track by $index">
						{{value}}
	                </md-checkbox>
              </fieldset>
		
		<md-checkbox ng-if="type == 'checkbox' && !subdata" ng-model="data_source.value" ng-checked="{{checked}}">
			{{label}}
		</md-checkbox>
		
	</md-content>
	<md-content ng-if="type == 'autocomplete'" ng-controller="autocompleteController as actrl">
		<label ng-if="type != 'checkbox'" ng-bind="data.label"></label>
		<md-autocomplete
			  placeholder="{{data_source.label}}"
	          md-search-text="actrl.searchText"
	          md-items="item in actrl.querySearch(actrl.searchText)"
	          md-item-text="item.label"
	          md-min-length="0"
	          style="min-width: 600px"
	        >
	        <md-item-template>
	        	<div ng-if="item.label" style="padding-bottom: 5px; display: table; width: 100%;">
					<div style="display: table-cell; vertical-align: middle;" ng-if="item.img">
						<img ng-src="{{item.img}}" style="vertical-align: middle; margin-right: 15px;">
					</div>
					<div style="overflow: hidden;">
						<div ng-if="item.label" md-highlight-text="actrl.searchText" md-highlight-flags="^i">{{item.label}}</div>
						<div ng-if="item.extra"><p style="margin: 0px; color: grey">({{item.extra}})</p></div>
					</div>
				</div>
				<div ng-if="!value.label">
					<span md-highlight-text="actrl.searchText" md-highlight-flags="^i">{{item.label}}</span>
				</div>
	        </md-item-template>
	        <md-not-found>
	          No items matching "{{actrl.searchText}}" were found.
	        </md-not-found>
	      </md-autocomplete>
	</md-content>
</md-input-container>